{% extends "layout.html" %} {% block body %}

<link href="{{ url_for('static', filename='./bower_components/keen-dashboards/dist/keen-dashboards.css') }}" rel="stylesheet">
<link href="{{ url_for('static', filename='./bower_components/colorbrewer/colorbrewer.css') }}" rel="stylesheet">
<link href="{{ url_for('static', filename='./bower_components/dcjs/dc.css') }}" rel="stylesheet">

<script src="{{ url_for('static', filename='./bower_components/crossfilter/crossfilter.js') }}"></script>
<script src="{{ url_for('static', filename='./bower_components/d3/d3.js') }}"></script>
<script src="{{ url_for('static', filename='./bower_components/dcjs/dc.js') }}"></script>
<script src="{{ url_for('static', filename='./bower_components/reductio/reductio.js') }}"></script>
<script src="{{ url_for('static', filename='./bower_components/colorbrewer/colorbrewer.js') }}"></script>
<script src="{{ url_for('static', filename='./holderjs/holder.js') }}"></script>
<script src="{{ url_for('static', filename='./dashboards.js') }}"></script>

<style>
/* Center the loader */
#loader {
  position: absolute;
  left: 50%;
  top: 50%;
  z-index: 1;
  width: 150px;
  height: 150px;
  margin: -75px 0 0 -75px;
  border: 16px solid #f3f3f3;
  border-radius: 50%;
  border-top: 16px solid #3498db;
  width: 120px;
  height: 120px;
  -webkit-animation: spin 2s linear infinite;
  animation: spin 2s linear infinite;
}

.body {
  margin-top: 50;
}

.top-row {
  margin-top:40px;
}

@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Add animation to "page content" */
.animate-bottom {
  position: relative;
  -webkit-animation-name: animatebottom;
  -webkit-animation-duration: 1s;
  animation-name: animatebottom;
  animation-duration: 1s
}

@-webkit-keyframes animatebottom {
  from { bottom:-100px; opacity:0 }
  to { bottom:0px; opacity:1 }
}

@keyframes animatebottom {
  from{ bottom:-100px; opacity:0 }
  to{ bottom:0; opacity:1 }
}

#myDiv {
  display: none;
  text-align: center;
}

.dc-chart path.line {
  stroke-width: 0px;
}

.dc-chart path.area {
  fill-opacity: 0.60;
}

</style>

<script>
  $(function() {
              console.log("document is ready is ready");

              // TODO -- remove this debug line
              // Holder.add_theme("white", {
              //     background: "#fff",
              //     foreground: "#a7a7a7",
              //     size: 10
              // });
              var projectName = '{{ project_name }}';
              if (projectName === null) {
                  projectName = this.pathname.split('/').pop();
                  alert("project name was null. Setting it to " + projectName); // TODO -- remove this debug line
              }

              var requestUrl = "/api/commits?project_name=" + projectName;

              $.getJSON(requestUrl, function(data) {
                  // alert("Got data back from JSON query: " + data)
                  // TODO -- add loading spinner or something
                  $("body").fadeIn(2000)
                  buildDashboards(data);
              });
            });
      //       $.ajax({
      //         xhr: function()
      //         {
      //           var xhr = new window.XMLHttpRequest();
      //           //Upload progress
      //           xhr.upload.addEventListener("progress", function(evt){
      //             if (evt.lengthComputable) {
      //               var percentComplete = evt.loaded / evt.total;
      //               //Do something with upload progress
      //               console.log(percentComplete);
      //             }
      //           }, false);
      //           //Download progress
      //           xhr.addEventListener("progress", function(evt){
      //             if (evt.lengthComputable) {
      //               var percentComplete = evt.loaded / evt.total;
      //               //Do something with download progress
      //               console.log(percentComplete);
      //             }
      //           }, false);
      //           return xhr;
      //         },
      //         type: 'GET',
      //         url: requestUrl,
      //         data: {},
      //         success: function(data){
      //           //Do something success-ish
      //         }
      //       });
      //
      // });

</script>


<!-- <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../">
          <span class="glyphicon glyphicon-chevron-left"></span>
        </a>
        <a class="navbar-brand" href="./">Layouts &raquo; Hero Sidebar</a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav navbar-left">
          <li><a href="https://keen.io">Home</a></li>
          <li><a href="https://keen.io/team">Team</a></li>
          <li><a href="https://github.com/keenlabs/dashboards/tree/gh-pages/layouts/hero-sidebar">Source</a></li>
          <li><a href="https://groups.google.com/forum/#!forum/keen-io-devs">Community</a></li><li><a href="http://stackoverflow.com/questions/tagged/keen-io?sort=newest&pageSize=15">Technical Support</a></li>
        </ul>
      </div>
    </div>
  </div> -->

  <div class="container-fluid top-row">

    <div class="row">
      <div class="col-sm-3">
        <div class="chart-wrapper">
          <div class="chart-title">
            Top Contributors
          </div>
          <div class="chart-stage">
              <div id="top-authors"></div>
          </div>
        </div>
      </div>
      <div class="col-sm-9">


        <div class="row">
          <div class="col-sm-12">
            <div class="chart-wrapper">
              <div class="chart-title">
                Commit History
              </div>
              <div class="chart-stage">
                <div id="commits-timeline"></div>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12">
            <div class="chart-wrapper">
              <!-- <div class="chart-title">
                Cell Title
              </div> -->
              <div class="chart-stage">
                <div id="defects-distribution"></div>
              </div>
              <div class="chart-notes">
                Distribution of Defects
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12">
            <div class="chart-wrapper">
              <div class="chart-title">
                Code Frequency
              </div>
              <div class="chart-stage">
                <div id="code-frequency"></div>
              </div>
              <div class="chart-notes">
                Notes about this chart
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


    <hr>

    <p class="small text-muted offset-left">Built by Davis Haba, as a part of the capstone project for the Galvanize Data Science immersive program.</a></p>

  </div>


{% endblock %}
