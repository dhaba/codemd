{% extends "layout.html" %} {% block body %}

<link href="{{ url_for('static', filename='./bower_components/keen-dashboards/dist/keen-dashboards.css') }}" rel="stylesheet">
<link href="{{ url_for('static', filename='./bower_components/dcjs/dc.css') }}" rel="stylesheet">

<script src="{{ url_for('static', filename='./bower_components/d3/d3.js') }}"></script>
<script src="{{ url_for('static', filename='./bower_components/crossfilter/crossfilter.js') }}"></script>
<script src="{{ url_for('static', filename='./bower_components/reductio/reductio.js') }}"></script>
<script src="{{ url_for('static', filename='./bower_components/dcjs/dc.js') }}"></script>
<script src="{{ url_for('static', filename='./holderjs/holder.js') }}"></script>

<script src="{{ url_for('static', filename='./dashboards.js') }}"></script>
<script>
    $(function() {
        console.log("document is ready is ready");

        // TODO -- remove this debug line
        Holder.add_theme("white", {
            background: "#fff",
            foreground: "#a7a7a7",
            size: 10
        });
        var projectName = '{{ project_name }}';
        if (projectName === null) {
            projectName = this.pathname.split('/').pop();
            alert("project name was null. Setting it to " + projectName); // TODO -- remove this debug line
        }
        var requestUrl = "/api/commits?project_name=" + projectName;

        $.getJSON(requestUrl, function(data) {
            // alert("Got data back from JSON query: " + data)
            buildDashboards(data);
        });
    });
</script>



<div class="container-fluid">

    <!-- ROW 1 - Commits Timeline -->
    <!-- <div class="row" id="first-row">
        <div class="col-md-1">
            <div class="chart-wrapper">
                <div class="chart-title">
                    Left Overview
                </div>
                <div class="chart-stage">
                </div>
            </div>
        </div> -->
    <div class="col-md-10">
        <div class="chart-wrapper">
            <div class="chart-title">
                Commits By Week
            </div>
            <div class="chart-stage">
                <div id="commits-timeline">
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-2">
        <div class="chart-wrapper">
            <div class="chart-title">
                Right Overview
            </div>
            <div class="chart-stage">

            </div>
        </div>
    </div>
</div>

<!-- ROW 2 - Defects Distribution -->
<!-- <div class="row" id="second-row">
        <div class="col-md-1">
            <div class="chart-wrapper">
                <div class="chart-title">
                    Left Overview
                </div>
                <div class="chart-stage">

                </div>
            </div>
        </div> -->
<div class="col-md-10">
    <div class="chart-wrapper">
        <div class="chart-title">
            Distribution of Defects
        </div>
        <div class="chart-stage">
            <div id="defects-distribution"></div>
        </div>
    </div>
</div>
<div class="col-md-2">
    <div class="chart-wrapper">
        <div class="chart-title">
            Right Overview
        </div>
        <div class="chart-stage">

        </div>
    </div>
</div>
</div>

<!-- ROW 3 - Churn Metrics and Author Contributions -->
<div class="row" id="third-row">
    <div class="col-md-4">
        <div class="chart-wrapper">
            <div class="chart-title">
                Development Velocity
            </div>
            <div class="chart-stage">
                <div id="churn-over-del"></div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="chart-wrapper">
            <div class="chart-title">
                Code Frequency
            </div>
            <div class="chart-stage">
                <div id="code-frequency"></div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="chart-wrapper">
            <div class="chart-title">
                Top Contributors
            </div>
            <div class="chart-stage">
            </div>
        </div>
    </div>
</div>

<!-- ROW 4 - Churned / Total (high = likely bugs) -->
<div class="row" id="third-row">
    <div class="col-md-1">
        <div class="chart-wrapper">
            <div class="chart-title">
                Left Overview
            </div>
            <div class="chart-stage">
            </div>
        </div>
    </div>
    <div class="col-md-10">
        <div class="chart-wrapper">
            <div class="chart-title">
            </div>
            <div class="chart-stage">
                <div id="churn-over-total"></div>
            </div>
        </div>
    </div>
    <div class="col-md-1">
        <div class="chart-wrapper">
            <div class="chart-title">
                Right Overview
            </div>
            <div class="chart-stage">
            </div>
        </div>
    </div>
</div>

<!-- Row 4 (TODO put stuff in here) -->
<div class="row" id="bottomrow">
    <div class="col-md-4">
        <div class="chart-wrapper">
            <div class="chart-title">
                Bug Distribution
            </div>
            <div class="chart-stage">
                <img data-src="holder.js/100%x180/white/text:#grid-2-1">
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="chart-wrapper">
            <div class="chart-title">
                Code Churn
            </div>
            <div class="chart-stage">
                <div id="code-churn"></div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="chart-wrapper">
            <div class="chart-title">
                Top Contributors
            </div>
            <div class="chart-stage">
                <img data-src="holder.js/100%x180/white/text:#grid-2-3">
            </div>
        </div>
    </div>
</div>

</div>

<table class='table table-hover' id='data-table'>
    <thead>
        <tr class='header'>
            <th>insertions</th>
            <th>deletions</th>
            <th>author</th>
            <th>date</th>
        </tr>
    </thead>
</table>

<div id="json-data"></div>

{% endblock %} %}
